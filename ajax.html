<!DOCTYPE html>

<script>

	onload = function() {

		// Create a canvas element
		const canvas = document.createElement("canvas")

		// Add it to the DOM
		document.body.appendChild(canvas)

		// Define canvas (view port)
		const context = canvas.getContext("2d")

		// Set canvas size
		const width = canvas.width = window.innerWidth * .95
		const height = canvas.height = window.innerHeight * .92

		// Circle wrapper
		function circle(x, y, r) {

			context.beginPath()

			context.arc(
				x,
				y,
				r,
				0,
				2 * Math.PI,
				false)

			context.fill()
		}

		// Create a new AJAX request
		var client = new XMLHttpRequest()

		// Set up handler for AJAX response
		client.onreadystatechange = function() {

			// Check response is a good one
			if (this.readyState === 4 && this.status === 200) {

				// Parse as JSON
				const response = JSON.parse(client.responseText)

				for (var i in response.packets) {

					const x = response.packets[i].one * width
					const y = response.packets[i].two * height

					circle(x, y, 1)
				}
			}
		}

		// Peridically request an update
		setInterval(function() {

			client.open("GET", "http://0.0.0.0:8000/cgi-bin/serve.cgi")
			client.send()
		}, 1000)
	}
</script>
