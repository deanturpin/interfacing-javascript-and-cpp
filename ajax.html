<!DOCTYPE html>

<script>

	onload = function() {

		// Create a new AJAX request
		var client = new XMLHttpRequest()

		// Set up handler for AJAX response
		client.onreadystatechange = function() {

			// Check response is a good one
			if (this.readyState === 4 && this.status === 200) {

				// Parse as JSON
				const response = JSON.parse(client.responseText)

				var summary = "<p>" + response.type + "<br>"

				for (var i in response.packets) {

					for (var j in response.packets[i])
						summary += j + ":" + response.packets[i][j] + " "
				
					summary += "<br>"
				}

				summary += "</p>"

				// Prepend summary to the top of the DOM
				document.body.innerHTML = summary + document.body.innerHTML
			}
		}

		// Peridically request an update
		setInterval(function() {

			client.open("GET", "http://0.0.0.0:8000/cgi-bin/serve.cgi")
			client.send()
		}, 1000)
	}
</script>
